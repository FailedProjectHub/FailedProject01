function isMobile(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a}function CommentLoader(a,b,c){null==c&&(c=function(){});var d=null;d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),d.open("GET",a,!0),d.send();var e=b;d.onreadystatechange=function(){if(4==d.readyState&&200==d.status)if("Microsoft Internet Explorer"==navigator.appName){var a=new ActiveXObject("Microsoft.XMLDOM");a.async=!1,a.loadXML(d.responseText),e.load(BilibiliParser(a)),c()}else e.load(BilibiliParser(d.responseXML)),c()}}function createCORSRequest(a,b){var c=new XMLHttpRequest;return"withCredentials"in c?c.open(a,b,!0):"undefined"!=typeof XDomainRequest?(c=new XDomainRequest,c.open(a,b)):c=null,c}var ABP={version:"0.8.0.1-sMod_bili"};!function(){"use strict";if(ABP){var a=function(a,c,d,e){var f=null;if("text"===a)return document.createTextNode(c);f=document.createElement(a);for(var g in c)if("style"===g)for(var h in c.style)f.style[h]=c.style[h];else"className"===g?f.className=c[g]:"html"===g?f.innerHTML=c[g]:"tooltip"===g?(f.tooltip=c[g],b(f.tooltip,"ABP-Tooltip"),f.addEventListener("mouseover",function(a){document.body.appendChild(f.tooltip);var b=document.documentElement.getBoundingClientRect(),c=f.getBoundingClientRect(),d=f.tooltip.getBoundingClientRect();c.bottom+5+d.height<document.documentElement.clientHeight?(f.tooltip.style.left=c.left-b.left+c.width/2-d.width/2+"px",f.tooltip.style.top=c.bottom-b.top+2+"px"):(f.tooltip.style.left=c.left-b.left+c.width+2+"px",f.tooltip.style.top=c.top-b.top+c.height/2-d.height/2+"px");var d=f.tooltip.getBoundingClientRect();d.right>document.documentElement.clientWidth?f.tooltip.style.left=c.left-b.left-d.width-2+"px":d.left<0&&(f.tooltip.style.left=c.left-b.left+c.width+2+"px"),"undefined"!=typeof f.updatetooltip&&f.updatetooltip&&f.updatetooltip(a)}),f.addEventListener("mousemove",function(a){"undefined"!=typeof f.updatetooltip&&f.updatetooltip&&f.updatetooltip(a)}),f.addEventListener("mouseout",function(){document.body.removeChild(f.tooltip)})):"updatetooltip"===g?f.updatetooltip=c[g]:f.setAttribute(g,c[g]);if(d)for(var i=0;i<d.length;i++)null!=d[i]&&f.appendChild(d[i]);return e&&"function"==typeof e&&e(f),f},b=function(a,b){if(null!=a){var c=a.className.split(" ");c.indexOf(b)<0&&c.push(b),a.className=c.join(" ")}},c=function(a,b){if(null==a)return!1;var c=a.className.split(" ");return c.indexOf(b)>=0},d=function(a,b){if(null!=a){var c=a.className.split(" ");c.indexOf(b)>=0&&c.splice(c.indexOf(b),1),a.className=c.join(" ")}},e=function(a,b){var c={};for(var d in b)c[d]=a&&"undefined"!=typeof a[d]?a[d]:b[d];return c},f=function(a){var b=document.createEvent("HTMLEvents");return b.initEvent(a,!1,!1),b},g=function(b,c){var d,e=a("div",{className:"dark"}),g=a("div",{className:"load"});d="undefined"!=typeof c?a("div",{className:"bar",tooltip:a("div",{}),updatetooltip:c},[g,e]):a("div",{className:"bar"},[g,e]),b.appendChild(d),b.bar=d;var h,i;b.progress={get main(){return h},set main(a){"number"!=typeof a||0>a||a>100||(h=a,e.style.width=a+"%")},get secondary(){return i},set secondary(a){"number"!=typeof a||0>a||a>100||(i=a,g.style.width=a+"%")}},b.progress.main=0,b.progress.secondary=0;var j,k=!1;return d.addEventListener("mousedown",function(a){k=!0;var c=a.clientX-this.getBoundingClientRect().left;c>=0&&c<=this.offsetWidth&&(j=100*c/this.offsetWidth),b.progress.main=j,b.dispatchEvent(new Event("startdrag"))}),document.addEventListener("mouseup",function(){k&&(k=!1,b.dispatchEvent(new Event("stopdrag")))}),d.addEventListener("mouseup",function(a){k=!1;var c=a.clientX-this.getBoundingClientRect().left;c>=0&&c<=this.offsetWidth&&(j=100*c/this.offsetWidth),b.progress.main=j,b.dispatchEvent(new Event("stopdrag"))}),d.addEventListener("mousemove",function(a){if(k){var c=a.clientX-this.getBoundingClientRect().left;c>=0&&c<=this.offsetWidth&&(j=100*c/this.offsetWidth,b.progress.main=j,b.dispatchEvent(f("ondrag")))}}),b},h=function(a){var b=parseInt(a),c=parseInt(b/60);return b%=60,c+":"+(10>b?"0":"")+b},i=function(a,b){for(var c=a.toString().length;b>c;)a="0"+a,c++;return a};ABP.create=function(b,d){var f=b;d||(d={}),d=e(d,{replaceMode:!0,width:1280,height:640,src:"",mobile:!1}),"string"==typeof b&&(f=document.getElementById(b)),f.children.length>0&&d.replaceMode&&(f.innerHTML="");var g;c(f,"ABP-Unit")?g=f:(g=a("div",{className:"ABP-Unit",style:{width:d.width+"px",height:d.height+"px"}}),f.appendChild(g));var j=[];if("string"==typeof d.src)d.src=a("video",{className:"ABP-VideoItem",preload:"meatdata"},[a("source",{src:d.src})]),j.push(d.src);else if(d.src.hasOwnProperty("playlist"))for(var k=d.src,l=k.playlist,m=0;m<l.length;m++)if(l[m].hasOwnProperty("sources")){var n=[];for(var o in l[m].sources)n.push(a("source",{src:l[m].sources[o],type:o}));j.push(a("video",{className:0==m?"ABP-VideoItem":"ABP-VideoItem ABP-VideoItemHidden",preload:"metadata"},n))}else l[m].hasOwnProperty("video")?j.push(l[m].video):console.log("No recognized format");else j.push(d.src);for(var p=[],q=0;q<j.length;q++)p.push(j[q]);p.push(a("div",{className:"ABP-Container"})),g.appendChild(a("div",{className:"ABP-Player"},[a("div",{className:"ABP-Video",tabindex:"10"},p),a("div",{className:"ABP-Toolbar"},[a("div",{className:"ABP-Text"},[a("div",{className:"button ABP-CommentFont",tooltip:a("div",{html:"弹幕大小与弹幕模式（未实现）"})}),a("div",{className:"button ABP-CommentColor",tooltip:a("div",{html:"弹幕颜色（未实现）"})}),a("div",{className:"button right ABP-CommentSend",tooltip:a("div",{html:"毁灭地喷射白光！da！"}),html:"发送 >"}),a("div",{className:"ABP-TextBox autofill"},[a("input",{type:"text"})])]),a("div",{className:"ABP-Control"},[a("div",{className:"button ABP-Play",tooltip:a("div",{html:"播放/暂停"})}),a("div",{className:"button right ABP-FullScreen",tooltip:a("div",{html:"全屏播放"})}),a("div",{className:"button right ABP-FullWindow",tooltip:a("div",{html:"网页全屏"})}),a("div",{className:"button right ABP-WideScreen",tooltip:a("div",{html:"宽屏"})}),a("div",{className:"button right ABP-Loop",tooltip:a("div",{html:"洗脑循环"})}),a("div",{className:"button right ABP-CommentShow",tooltip:a("div",{html:"弹幕开关"})}),a("div",{className:"ABP-Opacity"},[a("div",{html:"透明度"}),a("div",{className:"opacity-bar"})]),a("div",{className:"volume-bar right",tooltip:a("div",{html:"音量调节"})}),a("div",{className:"button right ABP-VolumeButton",tooltip:a("div",{html:"静音"})}),a("div",{className:"right ABP-TimeLabel"}),a("div",{className:"progress-bar autofill"})])]),a("div",{className:"box ABP-CommentFont-Box"}),a("div",{className:"box ABP-CommentColor-Box"})])),g.appendChild(a("div",{className:"ABP-CommentList ABP-SideBlock"},[a("div",{className:"ABP-CommentList-Title"},[a("div",{className:"time",html:"时间"}),a("div",{className:"content",html:"评论"}),a("div",{className:"date",html:"发送日期"})]),a("div",{className:"ABP-CommentList-Container"})])),g.appendChild(a("div",{className:"ABP-InfoBox ABP-SideBlock"},[])),g.appendChild(a("div",{className:"ABP-Settings ABP-SideBlock"},[]));var r=ABP.bind(g,d.mobile);return d.src.hasOwnProperty("danmaku")&&(r.cmManager.timeline=[],CommentLoader(d.src.danmaku,r.cmManager,function(){for(var b=g.getElementsByClassName("ABP-CommentList-Container")[0],c=0;c<r.cmManager.timeline.length;c++){var d=new Date(1e3*r.cmManager.timeline[c].date),e=a("div",{className:"ABP-CommentList-Item"},[a("div",{className:"time",html:h(parseInt(r.cmManager.timeline[c].stime/1e3))}),a("div",{className:"content",html:r.cmManager.timeline[c].text,tooltip:a("div",{html:r.cmManager.timeline[c].text})}),a("div",{className:"date",html:d.getMonth()+"-"+d.getDate()+" "+d.getHours()+":"+i(d.getMinutes(),2),tooltip:a("div",{html:d.getFullYear()+"-"+d.getMonth()+"-"+d.getDate()+" "+d.getHours()+":"+i(d.getMinutes(),2)+":"+i(d.getSeconds(),2)})})]);b.appendChild(e)}})),"undefined"!=typeof ABP_Restyle&&ABP_Restyle(),r},ABP.bind=function(a,c,i){function j(a){d(q.videos[a],"ABP-VideoItemHidden");for(var c=0;c<q.videos.length;c++)c!=a&&b(q.videos[c],"ABP-VideoItemHidden");q.currentItem=a}function k(a){q.videos[q.currentItem].pause();for(var b=0;b<q.videos.length&&a>q.videos[b].duration;)a-=q.videos[b].duration,b++;b>=q.videos.length||(q.videos[b].currentTime=a,j(b),q.cmManager&&(q.cmManager.time(parseInt(1e3*a)),q.cmManager.clear()),q.playing&&(q.cmManager&&q.state.danmaku&&q.cmManager.startTimer(),q.videos[q.currentItem].play()))}var l=0,m=!1,n=!1,o=[],p=100,q={btnPlay:null,divComment:null,btnFullScr:null,btnFullWin:null,btnWide:null,btnDm:null,btnLoop:null,videos:null,timeLabel:null,divTextField:null,txtText:null,cmManager:null,currentItem:0,duration:0,buffered:0,defaults:{w:0,h:0},state:e(i,{widescreen:!1,fullwindow:!1,fullscreen:!1,allowRescale:!1,autosize:!1,loop:!1,danmaku:!0,mute:!1}),resetLayout:null,wideScreen:null,fullWindow:null,ready:!1,play:null,pause:null,playing:!1,get currentTime(){return l},set currentTime(a){k(a)},addListener:null,dispatch:null,disableTime:15},r=function(a){return 100*a/q.duration};q.addListener=function(a,b){return"string"!=typeof a?void console.err(a+" is not a event name"):"function"!=typeof b?void console.err(b+" is not a listener"):("undefined"==typeof o[a]&&(o[a]=[]),void o[a].push(b))},q.dispatch=function(a,b){if("undefined"!=typeof o[a])for(var c=0;c<o[a].length;c++)"undefined"!=typeof b?o[a][c](b):o[a][c]()},q.resetLayout=function(){if(q.state.widescreen=!1,q.state.fullwindow=!1,q.state.fullscreen=!1,window.outerHeight==screen.height&&window.outerWidth==screen.width){var b=document,c=b.cancelFullScreen||b.webkitCancelFullScreen||b.mozCancelFullScreen||b.exitFullScreen;if("undefined"!=typeof c&&c)c.call(b);else if("undefined"!=typeof window.ActiveXObject){var e=new ActiveXObject("WScript.Shell");null!=e&&e.SendKeys("{F11}")}}d(a,"ABP-Wide"),d(a,"ABP-Full"),d(a,"ABP-Screen"),d(document.getElementsByTagName("body")[0],"ABP-NoScroll"),q.cmManager&&q.cmManager.setBounds()},q.wideScreen=function(){q.resetLayout(),b(a,"ABP-Wide"),q.state.widescreen=!0,q.cmManager&&q.cmManager.setBounds()},q.fullWindow=function(){q.resetLayout(),b(a,"ABP-Full"),b(document.getElementsByTagName("body")[0],"ABP-NoScroll"),q.state.fullwindow=!0,q.cmManager&&q.cmManager.setBounds()},q.fullScreen=function(){q.fullWindow();var c=document.documentElement,d=c.requestFullScreen||c.webkitRequestFullScreen||c.mozRequestFullScreen||c.msRequestFullScreen;if("undefined"!=typeof d&&d)d.call(c);else if("undefined"!=typeof window.ActiveXObject){var e=new ActiveXObject("WScript.Shell");null!=e&&e.SendKeys("{F11}")}b(a,"ABP-Screen"),q.cmManager&&q.cmManager.setBounds(),setTimeout(function(){q.state.fullscreen=!0},100)},q.play=function(){q.playing||(q.videos[q.currentItem].play(),q.cmManager&&q.state.danmaku&&q.cmManager.startTimer(),q.playing=!0,q.dispatch("play"))},q.pause=function(){q.playing&&(q.videos[q.currentItem].pause(),q.cmManager&&q.cmManager.stop(),q.playing=!1,q.dispatch("pause"))},q.setLoop=function(a){a?(q.state.loop=!0,b(q.btnLoop,"ABP-LoopOn")):(q.state.loop=!1,d(q.btnLoop,"ABP-LoopOn"))},q.setDanmaku=function(a){a?(q.cmManager.time(parseInt(1e3*q.currentTime)),q.cmManager.clear(),q.cmManager.startTimer(),d(q.btnDm,"ABP-DanmakuOff"),console.log("on progress")):(q.cmManager.stopTimer(),q.cmManager.clear(),b(q.btnDm,"ABP-DanmakuOff")),q.state.danmaku=a},q.mute=function(a){a!=q.state.mute&&(q.state.mute=a,a?(p=q.barVolume.progress.main,q.barVolume.progress.main=0,b(q.btnVolume,"muted")):(q.barVolume.progress.main=p,d(q.btnVolume,"muted")))},q.addListener("play",function(){q.cmManager.setBounds(),b(q.btnPlay,"ABP-Playing")}),q.addListener("pause",function(){d(q.btnPlay,"ABP-Playing")}),q.addListener("stop",function(){d(q.btnPlay,"ABP-Playing")}),q.addListener("progress",function(){console.log("on progress"),console.log(q.buffered),q.barProgress.progress.secondary=r(q.buffered)}),q.videos=a.getElementsByClassName("ABP-VideoItem"),q.btnPlay=a.getElementsByClassName("ABP-Play")[0],q.barProgress=g(a.getElementsByClassName("progress-bar")[0],null),q.btnFullWin=a.getElementsByClassName("ABP-FullWindow")[0],q.btnFullScr=a.getElementsByClassName("ABP-FullScreen")[0],q.btnWide=a.getElementsByClassName("ABP-WideScreen")[0],q.btnLoop=a.getElementsByClassName("ABP-Loop")[0],q.btnVolume=a.getElementsByClassName("ABP-VolumeButton")[0],q.barVolume=g(a.getElementsByClassName("volume-bar")[0]),q.barOpacity=g(a.getElementsByClassName("opacity-bar")[0],null),q.divTextField=a.getElementsByClassName("ABP-Text")[0],q.txtText=q.divTextField.getElementsByTagName("input")[0],q.btnDm=a.getElementsByClassName("ABP-CommentShow")[0],q.divComment=a.getElementsByClassName("ABP-Container")[0],q.timeLabel=a.getElementsByClassName("ABP-TimeLabel")[0],q.btnSend=a.getElementsByClassName("ABP-CommentSend")[0],q.videoarea=a.getElementsByClassName("ABP-Video")[0],q.defaults.w=q.divComment.offsetWidth,q.defaults.h=q.divComment.offsetHeight,"undefined"!=typeof CommentManager&&(q.cmManager=new CommentManager(q.divComment),q.cmManager.init(),q.cmManager.clear()),q.timeLabel.setTime=function(a){this.innerHTML=h(a)+"/"+h(q.duration)},window.addEventListener("resize",function(){!q.state.fullscreen||window.outerHeight==screen.height&&window.outerWidth==screen.width||q.resetLayout()});for(var s=0;s<q.videos.length;s++){var t=q.videos[s],u=0;t.itemNo=s,t.buffComplete=!1,t.addEventListener("loadedmetadata",function(){q.duration+=q.videos[this.itemNo].duration,u++,u==q.videos.length&&(q.ready=!0,console.log("ABP duration "+q.duration),q.timeLabel.setTime(0),q.videos[0].play(),q.videos[0].pause(),q.dispatch("ready")),q.videos[0].dispatchEvent(f("progress"))});t.addEventListener("progress",function(){var a,b,c=0;for(b=0;b<q.videos.length;b++){try{a=q.videos[b].buffered.end(0)}catch(d){break}if(c+=a,a<q.videos[b].duration)break}q.buffered=c,q.dispatch("progress"),q.buffered==q.duration?q.dispatch("buffered"):this.buffered.length>0&&this.buffered.end(0)==this.duration&&this.itemNo+1!=q.currentItem&&this.itemNo+1<q.videos.length&&(q.videos[this.itemNo+1].play(),q.videos[this.itemNo+1].pause())}),t.addEventListener("timeupdate",function(){if(this.itemNo==q.currentItem){n&&q.cmManager&&q.cmManager.startTimer(),n=!1;for(var a=this.currentTime,b=0;b<this.itemNo;b++)a+=q.videos[b].duration;l=a,m||(q.timeLabel.setTime(a),q.barProgress.progress.main=r(a)),q.cmManager.time(parseInt(1e3*a))}}),t.addEventListener("waitting",function(){this.itemNo==q.currentItem&&(!n&&q.cmManager&&q.cmManager.stopTimer(),n=!0)}),t.addEventListener("ended",function(){this.itemNo==q.currentItem&&(this.itemNo<q.videos.length-1?(j(this.itemNo+1),q.videos[this.itemNo+1].currentTime=0,q.videos[this.itemNo+1].play()):q.state.loop?k(0):(q.playing=!1,q.dispatch("stop")))})}if(q.btnFullScr.addEventListener("click",function(){q.state.fullscreen?q.resetLayout():q.fullScreen()}),q.btnFullWin.addEventListener("click",function(){!q.state.fullwindow||q.state.fullscreen?q.fullWindow():q.resetLayout()}),q.btnWide.addEventListener("click",function(){q.state.widescreen?q.resetLayout():q.wideScreen()}),q.btnDm.addEventListener("click",function(){q.setDanmaku(!q.state.danmaku)}),q.btnLoop.addEventListener("click",function(){q.setLoop(!q.state.loop)}),q.btnPlay.addEventListener("click",function(){q.playing?q.pause():q.play()}),q.videoarea.addEventListener("click",function(){q.playing?q.pause():q.play()}),q.barProgress.addEventListener("stopdrag",function(){k(this.progress.main/100*q.duration)}),q.barProgress.addEventListener("ondrag",function(){q.timeLabel.setTime(this.progress.main/100*q.duration)}),q.barProgress.bar.updatetooltip=function(a){var b=a.clientX-this.getBoundingClientRect().left;b>=0&&b<=this.offsetWidth&&(this.tooltip.innerHTML=h(b*q.duration/this.offsetWidth));var c=document.body.getBoundingClientRect(),d=this.getBoundingClientRect(),e=this.tooltip.getBoundingClientRect();this.tooltip.style.left=b+d.left-c.left-e.width/2+"px",this.tooltip.style.top=d.top-c.top-e.height+2+"px"},q.btnVolume.addEventListener("click",function(){q.mute(!q.state.mute)}),q.barVolume.progress.main=100,q.barVolume.addEventListener("stopdrag",function(){for(var a=0;a<q.videos.length;a++)q.videos[a].volume=q.barVolume.progress.main/100}),q.barVolume.addEventListener("ondrag",function(){for(var a=0;a<q.videos.length;a++)q.videos[a].volume=q.barVolume.progress.main/100}),q.barVolume.addEventListener("startdrag",function(){q.mute(!1)}),q.barOpacity.progress.main=100,q.barOpacity.addEventListener("stopdrag",function(){q.cmManager.options.global.opacity=q.barOpacity.progress.main/100}),q.barOpacity.addEventListener("ondrag",function(){q.cmManager.options.global.opacity=q.barOpacity.progress.main/100}),q.barOpacity.bar.updatetooltip=function(a){var b=a.clientX-this.getBoundingClientRect().left;b>=0&&b<=this.offsetWidth&&(this.tooltip.innerHTML=parseInt(b/this.offsetWidth*100)/100);var c=document.body.getBoundingClientRect(),d=this.getBoundingClientRect(),e=this.tooltip.getBoundingClientRect();this.tooltip.style.left=b+d.left-c.left-e.width/2+"px"},q.btnSend.addEventListener("click",function(){q.dispatch("senddanmaku",q.txtText.value)}),q.txtText.addEventListener("keydown",function(a){a&&13==a.keyCode&&q.dispatch("senddanmaku",q.txtText.value)}),q.addListener("senddanmaku",function(a){console.log("send danmaku: "+a),q.txtText.value="发射器冷却中......",q.txtText.setAttribute("disabled","disabled"),setTimeout(function(){q.txtText.value="",q.txtText.removeAttribute("disabled")},1e3*q.disableTime)}),a.addEventListener("keydown",function(a){a&&32==a.keyCode&&document.activeElement!==q.txtText&&(q.btnPlay.click(),a.preventDefault())}),"undefined"!=typeof CommentManager&&q.state.autosize){var v=function(){if(0!==video.videoHeight&&0!==video.videoWidth){var b=video.videoHeight/video.videoWidth,c=a.offsetWidth,d=a.offsetHeight,e=d/c;b>e?(a.style.width=d/b+"px",a.style.height=d+"px"):(a.style.width=c+"px",a.style.height=c*b+"px"),q.cmManager.setBounds()}};video.addEventListener("loadedmetadata",v),v()}return q}}}();